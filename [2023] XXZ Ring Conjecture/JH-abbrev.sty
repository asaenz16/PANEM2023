%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% cal font  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\calA}{\mathcal{A}}
\newcommand{\calB}{\mathcal{B}}
\newcommand{\calC}{\mathcal{C}}
\newcommand{\calD}{\mathcal{D}}
\newcommand{\calE}{\mathcal{E}}
\newcommand{\calF}{\mathcal{F}}
\newcommand{\calG}{\mathcal{G}}
\newcommand{\calH}{\mathcal{H}}
\newcommand{\calI}{\mathcal{I}}
\newcommand{\calJ}{\mathcal{J}}
\newcommand{\calK}{\mathcal{K}}
\newcommand{\calL}{\mathcal{L}}
\newcommand{\calM}{\mathcal{M}}
\newcommand{\calN}{\mathcal{N}}
\newcommand{\calO}{\mathcal{O}}
\newcommand{\calP}{\mathcal{P}}
\newcommand{\calQ}{\mathcal{Q}}
\newcommand{\calR}{\mathcal{R}}
\newcommand{\calS}{\mathcal{S}}
\newcommand{\calT}{\mathcal{T}}
\newcommand{\calU}{\mathcal{U}}
\newcommand{\calV}{\mathcal{V}}
\newcommand{\calW}{\mathcal{W}}
\newcommand{\calX}{\mathcal{X}}
\newcommand{\calY}{\mathcal{Y}}
\newcommand{\calZ}{\mathcal{Z}}

\newcommand{\dis}{\displaystyle}
%%%%%%%%%%%%%%%%%%%%%% frak font%%%%%%%%%%%%%%%%%%%%%
\newcommand{\fra}{\mathfrak{a}}
\newcommand{\frb}{\mathfrak{b}}
\newcommand{\frc}{\mathfrak{c}}
\newcommand{\frd}{\mathfrak{d}}
\newcommand{\fre}{\mathfrak{e}}
\newcommand{\frf}{\mathfrak{f}}
\newcommand{\frg}{\mathfrak{g}}
\newcommand{\frh}{\mathfrak{h}}
\newcommand{\fri}{\mathfrak{i}}
\newcommand{\frj}{\mathfrak{j}}
\newcommand{\frk}{\mathfrak{k}}
\newcommand{\frl}{\mathfrak{l}}
\newcommand{\frm}{\mathfrak{m}}
\newcommand{\frn}{\mathfrak{n}}
\newcommand{\fro}{\mathfrak{o}}
\newcommand{\frp}{\mathfrak{p}}
% \newcommand{\frq}{\mathfrak{q}}
\newcommand{\frr}{\mathfrak{r}}
\newcommand{\frs}{\mathfrak{s}}
\newcommand{\frt}{\mathfrak{t}}
\newcommand{\fru}{\mathfrak{u}}
\newcommand{\frv}{\mathfrak{v}}
\newcommand{\frw}{\mathfrak{w}}
\newcommand{\frx}{\mathfrak{x}}
\newcommand{\fry}{\mathfrak{y}}
\newcommand{\frz}{\mathfrak{z}}
\newcommand{\frA}{\mathfrak{A}}
\newcommand{\frB}{\mathfrak{B}}
\newcommand{\frC}{\mathfrak{C}}
\newcommand{\frD}{\mathfrak{D}}
\newcommand{\frE}{\mathfrak{E}}
\newcommand{\frF}{\mathfrak{F}}
\newcommand{\frG}{\mathfrak{G}}
\newcommand{\frH}{\mathfrak{H}}
\newcommand{\frI}{\mathfrak{I}}
\newcommand{\frJ}{\mathfrak{J}}
\newcommand{\frK}{\mathfrak{K}}
\newcommand{\frL}{\mathfrak{L}}
\newcommand{\frM}{\mathfrak{M}}
\newcommand{\frN}{\mathfrak{N}}
\newcommand{\frO}{\mathfrak{O}}
\newcommand{\frP}{\mathfrak{P}}
\newcommand{\frQ}{\mathfrak{Q}}
\newcommand{\frR}{\mathfrak{R}}
\newcommand{\frS}{\mathfrak{S}}
\newcommand{\frT}{\mathfrak{T}}
\newcommand{\frU}{\mathfrak{U}}
\newcommand{\frV}{\mathfrak{V}}
\newcommand{\frW}{\mathfrak{W}}
\newcommand{\frX}{\mathfrak{X}}
\newcommand{\frY}{\mathfrak{Y}}
\newcommand{\frZ}{\mathfrak{Z}}

%command \bb

\newcommand{\bbA}{\mathbb{A}}
\newcommand{\bbB}{\mathbb{B}}
\newcommand{\bbC}{\mathbb{C}}
\newcommand{\bbD}{\mathbb{D}}
\newcommand{\bbE}{\mathbb{E}}
\newcommand{\bbF}{\mathbb{F}}
\newcommand{\bbG}{\mathbb{G}}
\newcommand{\bbH}{\mathbb{H}}
\newcommand{\bbI}{\mathbb{I}}
\newcommand{\bbJ}{\mathbb{J}}
\newcommand{\bbK}{\mathbb{K}}
\newcommand{\bbL}{\mathbb{L}}
\newcommand{\bbM}{\mathbb{M}}
\newcommand{\bbN}{\mathbb{N}}
\newcommand{\bbO}{\mathbb{O}}
\newcommand{\bbP}{\mathbb{P}}
\newcommand{\bbQ}{\mathbb{Q}}
\newcommand{\bbR}{\mathbb{R}}
\newcommand{\bbS}{\mathbb{S}}
\newcommand{\bbT}{\mathbb{T}}
\newcommand{\bbU}{\mathbb{U}}
\newcommand{\bbV}{\mathbb{V}}
\newcommand{\bbW}{\mathbb{W}}
\newcommand{\bbX}{\mathbb{X}}
\newcommand{\bbY}{\mathbb{Y}}
\newcommand{\bbZ}{\mathbb{Z}}


%command \bf

\newcommand{\bfA}{\mathbf{A}}
\newcommand{\bfB}{\mathbf{B}}
\newcommand{\bfC}{\mathbf{C}}
\newcommand{\bfD}{\mathbf{D}}
\newcommand{\bfE}{\mathbf{E}}
\newcommand{\bfF}{\mathbf{F}}
\newcommand{\bfG}{\mathbf{G}}
\newcommand{\bfH}{\mathbf{H}}
\newcommand{\bfI}{\mathbf{I}}
\newcommand{\bfJ}{\mathbf{J}}
\newcommand{\bfK}{\mathbf{K}}
\newcommand{\bfL}{\mathbf{L}}
\newcommand{\bfM}{\mathbf{M}}
\newcommand{\bfN}{\mathbf{N}}
\newcommand{\bfO}{\mathbf{O}}
\newcommand{\bfP}{\mathbf{P}}
\newcommand{\bfQ}{\mathbf{Q}}
\newcommand{\bfR}{\mathbf{R}}
\newcommand{\bfS}{\mathbf{S}}
\newcommand{\bfT}{\mathbf{T}}
\newcommand{\bfU}{\mathbf{U}}
\newcommand{\bfV}{\mathbf{V}}
\newcommand{\bfW}{\mathbf{W}}
\newcommand{\bfX}{\mathbf{X}}
\newcommand{\bfY}{\mathbf{Y}}
\newcommand{\bfZ}{\mathbf{Z}}


%%%%%%%%%%%%%%%%%%%%%%%% Sf Fonts %%%%%%%%%%%%%%%%
\newcommand{\sfl}{{\sf l}}
\newcommand{\sfm}{{\sf m}}
\newcommand{\sfn}{{\sf n}}
\newcommand{\sfx}{{\sf x}}
\newcommand{\sfy}{{\sf y}}
\newcommand{\sfz}{{\sf z}}
\newcommand{\sfu}{{\sf u}}
\newcommand{\sfv}{{\sf v}}
\newcommand{\sft}{{\sf t}}
\newcommand{\sfs}{{\sf s}}
\newcommand{\sfe}{{\sf e}}
\newcommand{\sfw}{{\sf w}}
\newcommand{\sff}{{\sf f}}
\newcommand{\sfC}{{\sf C}}

%%%%%%%%%%%%%%  Index %%%%%%%%%%%%%%

\newcommand{\1}{{\rm (1)}}
\newcommand{\2}{{\rm (2)}}
\newcommand{\3}{{\rm (3)}}
\newcommand{\4}{{\rm (4)}}
\newcommand{\5}{{\rm (5)}}
\newcommand{\6}{{\rm (6)}}
\newcommand{\7}{{\rm (7)}}
\newcommand{\8}{{\rm (8)}}

\newcommand{\dd}{\textup{d}}

\newcommand{\bfz}{{\textbf{z}}}

\let\emptyset\varnothing


%\renewcommand{\qedsymbol}{$\blacktriangleleft$}
% \newcommand{\todo}[1]{{\color{red} #1}}
\newcommand{\Cst}{{\rm const}}
\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\newcommand{\mon}[1]{m_{(#1)}}
\DeclareMathOperator{\icomp}{{\rm i}}
\DeclareMathOperator*{\Res}{{\rm Res}\ }
\DeclareMathOperator*{\myre}{{\rm Re}}
\DeclareMathOperator*{\myim}{{\rm Im}}




% allow align in substack
\makeatletter
\newcommand{\subalign}[1]{%
  \vcenter{%
    \Let@ \restore@math@cr \default@tag
    \baselineskip\fontdimen10 \scriptfont\tw@
    \advance\baselineskip\fontdimen12 \scriptfont\tw@
    \lineskip\thr@@\fontdimen8 \scriptfont\thr@@
    \lineskiplimit\lineskip
    \ialign{\hfil$\m@th\scriptstyle##$&$\m@th\scriptstyle{}##$\hfil\crcr
      #1\crcr
    }%
  }%
}
\makeatother



\newcommand{\Prob}{\mathrm{Prob}}
\newcommand{\Hzeta}{\calH_\zeta}
\newcommand{\QXgf}[1][]{g(X^{#1}; \zeta; t)}
\newcommand{\Qgf}{g(\zeta; t)}
\newcommand{\QjXgf}[2]{g^{(#1)}(X; \zeta^{#2}; t)}
\newcommand{\Qjgf}[2]{g^{(#1)}(\zeta^{#2}; t)}

\newcommand{\Li}{\mathrm{Li}}


\newcommand{\icflat}{{(\mathtt{flat})}}
\newcommand{\icstep}{{(\mathtt{step})}}



\renewcommand{\epsilon}{\varepsilon}


\usepackage{ifthen}
\def\CIpidisplay{show}
\newcommand{\CIpi}[2][1]{
  \ifthenelse{\equal{\CIpidisplay}{show}}{
    \ifthenelse{\equal{#2}{1}}{
      \frac{#1}{2 \pi \icomp}
    }
    {
      \frac{#1}{(2 \pi \icomp)^{#2}}
    }
  }
  {
    \ifthenelse{\equal{#1}{1}}{
    }
    {
      #1
    }
  }
}


\newcommand\textsum{\textstyle\sum\nolimits}
% \newcommand\msum{\medop\sum}


\newcommand\textprod{\textstyle\prod\nolimits}
% \newcommand\mprod{\medop\prod}



% define contours

\gdef\diffcontoursz{\oint_{\epsilon'}^{R'}}
\gdef\diffcontoursZ{\oint_{\epsilon'}^{R'} \frac{\dd z}{z}}
\gdef\diffcontoursZdelta{\oint_{r_0-\delta}^{R'} \frac{\dd z}{z}}
\gdef\diffcontoursw{\oint_{\epsilon_1, \epsilon_2}^{R}}
\gdef\diffcontourA#1{\oint_{1 + C_{\epsilon_2}}^{1 + C_{\epsilon_3}} \frac{\dd w_{#1}}{w_{#1}}}



% define equations

% set of Bethe roots, no zeta
\gdef\calZset{
  \textstyle \calZ = \{ z \in \bbC^* \mid 1 + (-1)^N z^{-L} \prod_{i=1}^N (1 - \lambda_i^{-1}) = 0 \mbox{ for some } \lambda_1, \cdots, \lambda_N \in \calR(z) \}
}

% set of Bethe roots, with zeta
\gdef\calZzetaset{
  \textstyle \calZ_\zeta = \{ z \in \bbC^* \mid p_z(\vec{\lambda}; \zeta) := 1 + (-1)^N \zeta^L z^{-L} \prod_{i=1}^N (1 - \lambda_i^{-1}) = 0 \mbox{ for some } \lambda_1, \cdots, \lambda_N \in \calR(z) \}
}


% CI: no z only w, no zeta, general time t
\gdef\contourintR{
  \diffcontoursw \frac{\dd w_1}{w_1} \cdots \diffcontoursw \frac{\dd w_N}{w_N}
  \frac{ h_{\vec{w}} (Y) u_{\vec{w}} (X) e^{t E(\vec{w}) }}{ p_z( \vec{w} ) \prod_{i=1}^N q_z(w_i) }
}

% CI: no z only the w, no zeta, time=0
\gdef\contourintRic{
  \diffcontoursw \frac{\dd w_1}{w_1} \cdots \diffcontoursw \frac{\dd w_N}{w_N}
  \frac{ h_{\vec{w}} (Y) u_{\vec{w}} (X) }{ p_z( \vec{w} ) \prod_{i=1}^N q_z(w_i) }
}

% CI: z and w, no zeta, general time t
\gdef\bigcontourintR{
  \CIpi{N+1}
  \diffcontoursZ
  \contourintR
}
% CI: z and w, zeta = 1, general time t
\gdef\bigcontourintRzetaOne{
  \CIpi{N+1}
  \diffcontoursZ
  \contourintRzetaOne
}

% CI: z and w, no zeta, time=0
\gdef\bigcontourintRic{
  \CIpi{N+1} \diffcontoursZ
  \contourintRic
}



\gdef\sumNbetheroots{
  \sum_{ \substack{ \lambda_{i} \in \calQ(z) \\ 1 \leq i \leq N-1}  }
  \frac{  h_{\vec{\lambda}} (Y) u_{\vec{\lambda}} (X) e^{t E(\vec{\lambda}) } }
  { p_z(\vec{\lambda}) \prod_{i =1}^N (\lambda_i q_z'(\lambda_i))}
}


\gdef\eigenexpansion{
  \sum_{\vec{\lambda} \in \calR} \alpha_{\vec{\lambda}} h_{\vec{\lambda}}(Y)  u_{\vec{\lambda}}(X) e^{ t E(\vec{\lambda}) }
}



% CI: no z only w, zeta, general time t
\gdef\contourintRzeta{
  \diffcontoursw \frac{\dd w_1}{w_1} \cdots \diffcontoursw \frac{\dd w_N}{w_N}
  \frac{ h_{\vec{w}} (Y) u_{\vec{w}} (X) h_\zeta(X-Y) e^{t E(\vec{w}) }}
  { p_z( \vec{w} ; \zeta ) \prod_{i=1}^N q_z(w_i) }
}

% CI: no z only w, zeta, general time t, for current
\gdef\contourintRzetaC{
  \diffcontoursw \frac{\dd w_1}{w_1} \cdots \diffcontoursw \frac{\dd w_N}{w_N}
  \frac{ h_{\vec{w}} (Y) u_{\vec{w}} (X) e^{t E(\vec{w}) }}
  { p_z(\vec{w}; z) \prod_{i=1}^N q_z(w_i) } 
}

% CI: no z only w, zeta=1, general time t
\gdef\contourintRzetaOne{
  \diffcontoursw \frac{\dd w_1}{w_1} \cdots \diffcontoursw \frac{\dd w_N}{w_N}
  \frac{ h_{\vec{w}} (Y) u_{\vec{w}} (X)e^{t E(\vec{w}) }}
  { p_z( \vec{w} ; 1) \prod_{i=1}^N q_z(w_i) }
}

% CI: no z only the w, zeta, time=0
\gdef\contourintRiczeta{
  \diffcontoursw \frac{\dd w_1}{w_1} \cdots \diffcontoursw \frac{\dd w_N}{w_N}
  \frac{ h_{\vec{w}} (Y) u_{\vec{w}} (X) h_\zeta(X-Y) }
  { p_z( \vec{w} ; \zeta ) \prod_{i=1}^N q_z(w_i) }
}

% CI: z and w, zeta, general time t
\gdef\bigcontourintRzeta{
  \CIpi{N+1}
  \diffcontoursZ
  \contourintRzeta
}



% CI: z and w, zeta, time=0
\gdef\bigcontourintRiczeta{
  \CIpi{N+1} \diffcontoursZ
  \contourintRiczeta
}


% CI: z and w, zeta, general time t, for current
\gdef\bigcontourintRzetaC{
  \CIpi{N+1}
  \diffcontoursZ
  \contourintRzetaC
}


\gdef\sumNbetherootszeta{
  \sum_{ \substack{ \lambda_{i} \in \calQ(z) \\ 1 \leq i \leq N}  }
  \frac{  h_{\vec{\lambda}} (Y) u_{\vec{\lambda}} (X)  h_\zeta(X-Y) e^{t E(\vec{\lambda}) } }
  { p_z( \vec{\lambda}; \zeta ) \prod_{i =1}^N (\lambda_i q_z'(\lambda_i))}
}

\gdef\sumNbetherootszetaOne{
  \sum_{ \substack{ \lambda_{i} \in \calQ(z) \\ 1 \leq i \leq N}  }
  \frac{  h_{\vec{\lambda}} (Y) u_{\vec{\lambda}} (X)   e^{t E(\vec{\lambda}) } }
  { p_z( \vec{\lambda}; 1 ) \prod_{i =1}^N (\lambda_i q_z'(\lambda_i))}
}

\gdef\eigenexpansionzeta{
  \sum_{\vec{\lambda} \in \calR(\zeta)} \alpha_{\vec{\lambda}} h_{\vec{\lambda}}(Y) u_{\vec{\lambda}}(X) h_\zeta(X-Y) e^{ t E(\vec{\lambda}) }
}

\gdef\eigenexpansionzetaOne{
  \sum_{\vec{\lambda} \in \calR(1)} \alpha_{\vec{\lambda}} h_{\vec{\lambda}}(Y) u_{\vec{\lambda}}(X)  e^{ t E(\vec{\lambda}) }
}



\gdef\CISumAsymmetricIndT{
  \sum_{\substack{\lambda_i \in \calQ_1(z) \\ 1 \leq i \leq N-1} }
  \Bigg[
  \mathds{1}(w_N \in \calA) \
  \Bigg(
  \frac{1-w_N}{q_z(w_N)}
  \frac{ h_{\vec{w}}(Y) u_{\vec{w}}(X)  e^{t E(\vec{w})} }%
  { \prod_{i=1}^{N-1} w_i q_z'(w_i)} \Bigg)
  \Bigg]_{\subalign{ & (w_1, \dots, w_{N-1}) = (\lambda_1, \dots, \lambda_{N-1}) \\  & \phantom{(} w_{N} = \mu }}
}

\gdef\CISumAsymmetricT{
  \sum_{\substack{\lambda_i \in \calQ_1(z) \\ 1 \leq i \leq N-1} }
  \Bigg(
  \frac{w_N -1}{q_z(w_N)}
  \frac{ h_{\vec{w}}(Y) u_{\vec{w}}(X)  e^{t E(\vec{w})} }%
  { \prod_{i=1}^{N-1} w_i q_z'(w_i)}
  \Bigg)_{\subalign{ & (w_1, \dots, w_{N-1}) = (\lambda_1, \dots, \lambda_{N-1}) \\  & \phantom{(} w_{N} = \mu }}
}

